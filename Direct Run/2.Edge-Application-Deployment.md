- In this project we have deployed a CIFAR10 Object classification model as the Application for processing tasks in edge layer using kubernetes. You can use any application for here according to the requirements and change the Application file at the Build section to match your requiremants.
- This application deployed in edge nodes process user requests send the results to device which requested and also send the processed data to cloud storage for future training.
- The MicroK8s is in same VM where open5gs is installed.


## 1. Install MicroK8s
```
sudo apt update && sudo apt upgrade -y
sudo apt install snapd -y
sudo snap install microk8s --classic
sudo usermod -a -G microk8s $USER
sudo chown -f -R $USER ~/.kube
microk8s status --wait-ready
microk8s enable dns dashboard storage ingress
microk8s enable metrics-server registry hostpath-storage

test:
microk8s kubectl get nodes
```

## 2. Deployment and Service file for edge nodes

<p align="center">
  <img src="https://github.com/user-attachments/assets/15bef5bc-66f8-4b07-b9a3-2dc14618266f" alt="Throughput on End Device" width="600">
</p>


- âš¡Note: Here REMOTE_SERVER_URL is the Floating IP address of the VM we had created in Openstack for cloud storage. Set it accordingly. Refer above architecture for reference.



```bash
`vim edge-deployment.yml`
```
```
apiVersion: v1
kind: Pod
metadata:
  name: edge-node1
  labels:
    app: edge-node1
spec:
  containers:
  - name: edge-node1
    image: manojpandekamat/fastapi-application
    ports:
    - containerPort: 8000
    env:
    - name: REMOTE_SERVER_URL
      value: "http://10.2.2.114:8080/data"
---
apiVersion: v1
kind: Pod
metadata:
  name: edge-node2
  labels:
    app: edge-node2
spec:
  containers:
  - name: edge-node2
    image: manojpandekamat/fastapi-application
    ports:
    - containerPort: 8000
    env:
    - name: REMOTE_SERVER_URL
      value: "http://10.2.2.114:8080/data"
---
apiVersion: v1
kind: Pod
metadata:
  name: edge-node3
  labels:
    app: edge-node3
spec:
  containers:
  - name: edge-node3
    image: manojpandekamat/fastapi-application
    ports:
    - containerPort: 8000
    env:
    - name: REMOTE_SERVER_URL
      value: "http://10.2.2.114:8080/data"
---
# Services for each pod to expose different nodePorts
apiVersion: v1
kind: Service
metadata:
  name: edge-service1
spec:
  type: NodePort
  selector:
    app: edge-node1
  ports:
  - port: 8000
    targetPort: 8000
    nodePort: 30081
---
apiVersion: v1
kind: Service
metadata:
  name: edge-service2
spec:
  type: NodePort
  selector:
    app: edge-node2
  ports:
  - port: 8000
    targetPort: 8000
    nodePort: 30082
---
apiVersion: v1
kind: Service
metadata:
  name: edge-service3
spec:
  type: NodePort
  selector:
    app: edge-node3
  ports:
  - port: 8000
    targetPort: 8000
    nodePort: 30083
```


